<script type="text/javascript" src="Jmol.js"></script>
<center>
<script type="text/javascript">
//jmolInitialize(".","http://chemapps.stolaf.edu/pe/protexpl/molview/JmolAppletSigned.jar")
jmolInitialize(".","JmolAppletSigned.jar")

var xxxx = (document.location.search + "?1crn").substring(1,5)
script = 'set animframecallback "jmolscript:select model = _modelnumber";'
	+'set zoomlarge false;set echo top left;echo loading XXXX...;refresh;'
	+'load "http://www.rcsb.org/pdb/files/XXXX.pdb";set echo top center;echo XXXX;'
	+'spacefill off;wireframe off;cartoons on;color cartoon structure;'
script = script.replace(/XXXX/g, xxxx)
jmolApplet(["80%","80%"],script)
jmolBr()
jmolButton("color cpk")
jmolButton("color group")
jmolButton("color structure")
jmolBr()
jmolButton("trace only")
jmolButton("cartoon only")
jmolButton("backbone only")
jmolButton("spacefill only;spacefill 30%")
jmolBr()
jmolButton("Model")
jmolButton("Ramachandran relative")
jmolButton("Quaternion difference")
jmolBr()
jmolCommandInput()
jmolButton("console")

function search(what) {
  if (!what) what = prompt("Search for what?")
  if (!what) return
  var n = Math.random()
  jmolScript("set debugscript true;")
  var s = 'set scriptCallback "checkDone()";x=load("http://www.rcsb.org/pdb/search/smart.do?smartComparator=and&smartSearchSubtype_0=AdvancedKeywordQuery&keywords_0=' + what + '&searchScope_0=fullText");x = load("http://www.rcsb.org/pdb/results/titles.jsp?structureIdList="+load("http://www.rcsb.org/pdb/results/ids.jsp?' + n + '").split().join(","));#done'
  jmolScript(s)
}

function checkDone(a,b,c) {
alert([a,b,c])
  var s = jmolEvaluate("x")
alert(2)
  alert("checkdone: " + s) 

}

</script>
<a href=javascript:search()>search PDB...</a>
</center>
